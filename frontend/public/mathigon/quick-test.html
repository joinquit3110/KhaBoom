<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>KHA-BOOM! Mathigon Quick Test</title>
  <link rel="stylesheet" href="/mathigon/assets/course.css">
  <style>
    body {
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, sans-serif;
    }
    .controls {
      position: fixed;
      top: 10px;
      right: 10px;
      z-index: 1000;
      background: white;
      padding: 10px;
      border-radius: 5px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    button {
      margin: 5px;
      padding: 8px 12px;
      background: #1f7aff;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
    select {
      padding: 8px;
      margin: 5px;
    }
    #mathigon-textbook {
      width: 100vw;
      height: 100vh;
    }
  </style>
</head>
<body>
  <div class="controls">
    <select id="course-selector">
      <option value="circles">Circles</option>
      <option value="triangles">Triangles</option>
      <option value="probability">Probability</option>
      <option value="polyhedra">Polyhedra</option>
      <option value="sequences">Sequences</option>
    </select>
    <button onclick="loadCourse()">Load Course</button>
    <button onclick="location.reload()">Reload Page</button>
  </div>
  
  <div id="mathigon-textbook"></div>
  
  <script>
    // Default course
    window.courseId = 'circles';
    
    // Global configuration
    window.mathigonConfig = {
      assetsPrefix: '/mathigon/assets/',
      contentPrefix: '/mathigon/content/'
    };
    
    // Function to load a course
    function loadCourse() {
      const courseSelector = document.getElementById('course-selector');
      const courseId = courseSelector.value;
      window.courseId = courseId;
      
      console.log('Loading course:', courseId);
      
      // Remove any existing content
      const container = document.getElementById('mathigon-textbook');
      container.innerHTML = '';
      
      // Initialize Mathigon
      if (window.Mathigon && window.Mathigon.TextbookLoader) {
        try {
          const textbook = new window.Mathigon.TextbookLoader({
            courseId,
            container: '#mathigon-textbook',
            sourcePrefix: '/mathigon/content/',
            assetsPrefix: '/mathigon/assets/'
          });
          
          textbook.initialize().then(() => {
            console.log('Textbook initialized successfully');
          }).catch(err => {
            console.error('Error initializing textbook:', err);
            alert('Error initializing textbook: ' + (err.message || 'Unknown error'));
          });
        } catch (err) {
          console.error('Error creating textbook:', err);
          alert('Error creating textbook: ' + (err.message || 'Unknown error'));
        }
      } else if (window.Mathigon && window.Mathigon.load) {
        try {
          window.Mathigon.load().then(() => {
            console.log('Textbook loaded using Mathigon.load()');
          }).catch(err => {
            console.error('Error loading textbook:', err);
            alert('Error loading textbook: ' + (err.message || 'Unknown error'));
          });
        } catch (err) {
          console.error('Error using Mathigon.load:', err);
          alert('Error using Mathigon.load: ' + (err.message || 'Unknown error'));
        }
      } else {
        console.error('Mathigon not properly loaded');
        alert('Mathigon not properly loaded. Please check console for details.');
      }
    }
    
    // Load script on page load
    document.addEventListener('DOMContentLoaded', function() {
      const script = document.createElement('script');
      script.src = '/mathigon/assets/course.js';
      script.onload = function() {
        console.log('Mathigon course.js loaded successfully');
        // Auto-load the default course
        loadCourse();
      };
      script.onerror = function() {
        console.error('Failed to load Mathigon course.js');
        alert('Failed to load Mathigon course.js. Please check your network connection and try again.');
      };
      document.body.appendChild(script);
    });
  </script>
</body>
</html> 